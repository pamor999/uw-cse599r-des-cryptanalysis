\documentclass[9pt]{beamer}

\usepackage{amsmath,amssymb,amstext,amsfonts,setspace,dsfont,amsmath,amsthm,array,nomencl,hyperref,pgf,xcolor}

\usepackage{beamerthemesplit}

%\usetheme{Dresden}
\usetheme{Ilmenau}

\setbeamertemplate{navigation symbols}{} %no navigation symbols

\setbeamertemplate{footline}
{%
\leavevmode%
\hbox{%

\begin{beamercolorbox}[wd=.3\paperwidth,ht=2.5ex,dp=1.125ex,left]{author
in head/foot}%
\usebeamerfont{author in head/foot}\hspace{.3cm}\insertshortauthor\hspace{.3cm}
\end{beamercolorbox}%

\begin{beamercolorbox}[wd=.5\paperwidth,ht=2.5ex,dp=1.125ex,center]{title
in head/foot}%
\usebeamerfont{title in head/foot}\hspace{.3cm}\insertshorttitle
\end{beamercolorbox}%

\begin{beamercolorbox}[wd=.2\paperwidth,ht=2.5ex,dp=1.125ex,right]{author
in head/foot}%
\usebeamerfont{author in head/foot}Slide\hspace{.1cm}\insertframenumber\hspace{.1cm}of\hspace{.1cm}\inserttotalframenumber\hspace{.3cm}
\end{beamercolorbox}%
}%
\vskip0pt%
}

\setbeamertemplate{blocks}[rounded][shadow=true]

\title{Linear and Differential Cryptanalysis of DES}
\author{Slava Chernyak and Sourav Sen Gupta}
\institute{University of Washington}
\date{February 2, 2009}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\section{Introduction}
\begin{frame}{Introduction}
\begin{block}{Quack!}
Introduction to DES and the two attacks
\end{block}
\end{frame}

\subsection{Data Encrytption Standard}
\begin{frame}
DES structure

\end{frame}

\begin{frame}
DES pieces

\end{frame}

\begin{frame}
DES mathematics

\end{frame}

\subsection{Linear Cryptanalysis}
\begin{frame}
Vulnerabilities of DES

\end{frame}

\begin{frame}
Linear Attack on DES idea:\\
\begin{itemize}
\item S-Boxes depend on a relatively small number of bits (6) which allows us to write down linear (or afine) expressions that approximate S-Boxes \\
\item The effects of one round do not diffuse quickly over following rounds. Thus linear expresions (as above) that hold per-round can be combined across rounds.
\end{itemize}
\end{frame}

\begin{frame}
Specifically, if $P_{i}$ are plaintext bits, $C_{i}$ are cyphertext bits, and $K_{i}$ are subkey bits, then we wish to find an expression of the form
\[ P_{i_1} \oplus P_{i_2} \cdots P_{i_j} \oplus C_{i_1} \oplus C_{i_2} \cdots C_{i_k} = K_{i_1} \oplus K_{i_2} \oplus K_{i_m} \]
Such that this expression has a high \textit{or} low probability of occurence.\\
\vspace{5mm}
Consider: No such obvious expression should exist, otherwise the cipher is trivially weak. If we were to randomly select bits for the above expression, it would hold exactly $1/2$ the time. If we find an expression such as above that displays a high \textit{bias}, that is, it holds much more or less freqently than $1/2$ the time, we can exploit this.
\end{frame}


\subsection{Differential Cryptanalysis}
\begin{frame}
Vulnerabilities of DES

\end{frame}

\begin{frame}
How to exploit those - Differential attack idea

\end{frame}

\section{Mathematical Framework}
\begin{frame}
Mathematical description of the attacks

\end{frame}

\subsection{Simplification WLOG}
\begin{frame}
Reducing DES down to SPN

We can remove much of the complexity of DES without affecting the discussion of the techniques of Linear Cryptanalysis. We define a simple Substitution-Permutation Network Cipher (SPN) which has structural similarity to DES.

\begin{itemize}
\item SPN is a 16-bit block cipher (16-bit plaintext to 16-bit ciphertext) with 16-bit round keys.
\item Each round consists of a substitution and a permutation (much like in DES)
\item The substitution is the result of splitting the 16-bit input block to a round in to 4 4-bit sub-blocks. Each 4-bit sub-block is then mapped across a 4-bit to 4-bit S-box. We use the same S-box throughout. 
\item The permutation is applied to all 16-bits of the round following the substitution.
\item Finally, key-mixing is achieved by XOR-ing the round key with every input block to a round as well as at the end of the last round (so that we can't simply ignore the last round)
\item The SPN cipher we will look at will consist of 4 rounds.
\end{itemize}


\end{frame}

\begin{frame}
SPN Visually
%\pgfimage[scale=0.75]{SPN.PNG}
\end{frame}

\begin{frame}
SPN S-Box and Permutation:\\
\vspace{5mm}
SPN uses a single 4-bit S-Box that has the following structure:
\begin{tabular}{|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
Input: & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & A & B & C & D & E & F \\
\hline
Output:& E & 4 & D & 1 & 2 & F & B & 8 & 3 & A & 6 & C & 5 & 9 & 0 & 7 \\
\hline
\end{tabular}\\
\vspace{5mm}
And the following 16-bit permutation:
\begin{tabular}{|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 & 16\\
\hline
1 & 5 & 9 & 13 & 2 & 6 & 10 & 14 & 3 & 7 & 11 & 15 & 4 & 8 & 12 & 16 \\
\hline
\end{tabular}
\vspace{5mm}

\end{frame}

\subsection{Linear Attack on SPN}
\begin{frame}
\large{Basic Definitions for the Linear attack:}\\
\vspace{5 mm}
Linear cryptanalysis tries to take advantage of high probability occurrences of  linear expressions involving plaintext bits, ciphertext bits and subkey bits.  It is a known plaintext attack.\\
\vspace{5 mm}
Define $P_i$ where $i = 1, 2, \dots 16$ as the $i$-th plaintext bit.\\
Define $C_i$ where $i = 1, 2, \dots 16$ as the $i$-th cyphertext bit.\\
Define $U_{j,i}$ where $j = 1, 2, 3, 4$ and $i = 1, 2, \dots 16$ be the $i$-th input bit to the $j$-th round of SPN.\\
Define $V_{j,i}$ where $j = 1, 2, 3, 4$ and $i = 1, 2, \dots 16$ be the $i$-th output bit of the $j$-th round of SPN.\\
\end{frame}

\begin{frame}
Linear and Affine approximation of S-Box:\\
\vspace{5mm}
How do we come up with the desired expression for the entire cipher? We start by looking at the only non-linear component, the S-Box.\\
\vspace{5mm}
To find the linear/afine approximation of the S-Box we simply consider every possible expression of the input bits $X_i$ and output bits $Y_j$. Thus the expression has the form
\[ \bigoplus_{i \in U} X_i = \bigoplus_{j \in V} Y_j \]
Where $U$ and $V$ range over all possible subsets of $\{1, 2, 3 ,4\}$. We then compare how often this expression coincides with the S-Box. \\
\vspace{5mm}
Note that there are 16 possibilities for $U$ and $V$, hence 256 total possible expressions. (this is for a 4-bit S-box)
\end{frame}

\begin{frame}
S-Box approximatin example:\\
\vspace{5mm}
We can take the following expression as an example:
\[ X_2 \oplus X_3 = Y_1 \oplus Y_3 \oplus Y_4 \]
Applying all possible values for the input $X$ bits it turns out that the expression holds in 12 out of the 16 cases. Hence, this expression has a bias of $12/16 - 1/2 = 1/4$.\\
\vspace{5mm}
Similarly the following expression
\[ X_3 \oplus X_4 = Y_1 \oplus Y_4 \]
Has a bias of $-3/8$, which is higher in magnitude than the previous one. It is the magnitude of the bias that is important.
\end{frame}

\begin{frame}
The number of agreements (minus 8) between the S-Box and every possible expression is summarized in the table below. Thus to get the bias, one must only divide by 16.\\
\vspace{5mm}
\tiny
\begin{tabular}{|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|r|}
\hline
 &0&1&2&3&4&5&6&7&8&9&A&B&C&D&E&F\\
\hline
0&+8&0&0&0&0&0&0&0&0&0&0&0&0&0&0&0 \\
\hline
1&0&0&-2&-2&0&0&-2&\textbf{+6}&+2&+2&0&0&+2&+2&0&0 \\
\hline
2&0&0&-2&-2&0&0&-2&-2&0&0&+2&+2&0&0&\textbf{-6}&+2 \\
\hline
3&0&0&0&0&0&0&0&0&+2&\textbf{-6}&-2&-2&+2&+2&-2&-2 \\
\hline
4&0&+2&0&-2&-2&-4&-2&0&0&-2&0&+2&+2&-4&+2&0 \\
\hline
5&0&-2&-2&0&-2&0&+4&+2&-2&0&-4&+2&0&-2&-2&0  \\
\hline
6&0&+2&-2&+4&+2&0&0&+2&0&-2&+2&+4&-2&0&0&-2 \\
\hline
7&0&-2&0&+2&+2&-4&+2&0&-2&0&+2&0&+4&+2&0&+2  \\
\hline
8&0&0&0&0&0&0&0&0&-2&+2&+2&-2&+2&-2&-2&\textbf{-6} \\
\hline
9&0&0&-2&-2&0&0&-2&-2&-4&0&-2&+2&0&+4&+2&-2 \\
\hline
A&0&+4&-2&+2&-4&0&+2&-2&+2&+2&0&0&+2&+2&0&0 \\
\hline
B&0&+4&0&-4&+4&0&+4&0&0&0&0&0&0&0&0&0 \\
\hline
C&0&-2&+4&-2&-2&0&+2&0&+2&0&+2&+4&0&+2&0&-2 \\ 
\hline
D&0&+2&+2&0&-2&+4&0&+2&-4&-2&+2&0&+2&0&0&+2 \\
\hline
E&0&+2&+2&0&-2&-4&0&+2&-2&0&0&-2&-4&+2&-2&0 \\
\hline
F&0&-2&-4&-2&-2&0&+2&0&0&-2&+4&-2&-2&0&+2&0 \\
\hline
\end{tabular}
\small
\end{frame}

\begin{frame}
What this means for 1 Round:\\
\vspace{5mm}
Note, from the previous table, that the expression $X_1 \oplus X_3 \oplus X_4 = Y_2$ has a bias of $+1/4$. \\
\vspace{5mm}
Note also that $U_1 = P \oplus K_1$. 
\vspace{5mm} We can now write down the following linear approximation across the 1st round of SPN:
\begin{eqnarray*}
V_{1,6} & = & U_{1,5} \oplus U_{1,7} \oplus U_{1,8} \mbox{  $\leftarrow$ S-Box approximation above}\\
		  & = & (P_5\oplus K_{1,5}) \oplus (P_7\oplus K_{1,7}) \oplus (P_8\oplus K_{1,8})
\end{eqnarray*}
This expression holds with probability of $3/4$ (bias of $+1/4$)
\end{frame}

\begin{frame}
We can get expressions that hold with some non-$1/2$ probability for every round. But we must somehow combine them to write an expression relating the plaintext and ciphertext bits $\Rightarrow$ We use the Piling Up Principle:\\
\vspace{5mm}
Note: \\
$X_1 \oplus X_2 = 0$ is a linear expression equivalent to $X_1 = X_2$\\
$X_1 \oplus X_2 = 1$ is an affine expression equivalent to $X_1 \neq X_2$\\
\vspace{5mm}
Assume the following probability distribution
\[ Pr(X_1 = i)  = \left\{ \begin{array}{ll}
         p_1 & \mbox{$i = 0$};\\
         (1 - p_1) & \mbox{$i = 1$}.\end{array} \right. \] 
\[ Pr(X_2 = i)  = \left\{ \begin{array}{ll}
         p_2 & \mbox{$i = 0$};\\
         (1 - p_2) & \mbox{$i = 1$}.\end{array} \right. \] 
\end{frame}

\begin{frame}
Piling Up Principle Continued:\\
\vspace{5mm}
Assuming that $X_1$ and $X_2$ are independant:
\[ Pr(X_1 = i, X_2 = j)  = \left\{ \begin{array}{ll}
         p_1 p_2 & \mbox{$i = 0, j = 0$};\\
         (1 - p_1) p_2 & \mbox{$i = 1, j = 0$} \\
			p_1 (1 - p_2) & \mbox{$i = 0, j = 1$} \\
			(1 - p_1)(1 - p_2) & \mbox{$i = 1, j = 1$}.\end{array} \right. \] 
Now, note that $X_1 \oplus X_2 = 0 \Rightarrow X_1 = 1, X_2 =1$ OR $X_1 = 0, X_2 = 0$. Hence:
\begin{eqnarray*}
 Pr(X_1 \oplus X_2 = 0) & = & Pr(X_1=0,X_2=0) + Pr(X_1=1,X_2=1) \\
								& = & p_1p_2 + (1 - p_1)(1-p_2)
\end{eqnarray*}
If we write $p_k = 1/2 + \epsilon_k$ we have
\[ Pr(X_1 \oplus X_2 = 0) = 1/2 + 2\epsilon_1 \epsilon_2 \]
Hence the bias of $X_1 \oplus X_2 = 0$ is 
\[ 2 \epsilon_1 \epsilon_2 \]
That is, twice the product of the bias of the original expressions.
\end{frame}

\begin{frame}
Piling Up Principle Continued - The Piling Up Lemma:\\
\vspace{5mm}
We extend the idea on the previous slide to the general case: For $n$ independant random binary variables, $X_1, X_2, \dots, X_n$, 
\[ Pr(X_1 \oplus X_2 \cdots \oplus X_n = 0) = 1/2 + 2^{n-1} \prod_{i=1}^n \epsilon_i \]
In terms of bias,
\[ \epsilon_{1,2,\dots,n} = 2^{n-1} \prod_{i = 1}^n \epsilon_i \]
Where $\epsilon_{1,2,\dots,n}$ is the total bias of $X_1 \oplus X_2 \cdots \oplus X_n = 0$. \\
\vspace{5mm}
Note that if some $\epsilon_k = 0$ (that is, some $X_k$ has no bias) then the total bias will be $0$.  
\end{frame}

\begin{frame}
Combining across SPN rounds ... 

\end{frame}

\begin{frame}
The algorithm for the attack ... 

\end{frame}

\begin{frame}
Probabilistic justification ...

\end{frame}

\subsection{Differential Attack on SPN}
\begin{frame}
Basic math concepts behind Differential attack ...

\end{frame}

\begin{frame}
Intro to differentials ... 

\end{frame}

\begin{frame}
Differential characteristic / approximation of SBox ...

\end{frame}

\begin{frame}
Probabilities for the approximations ...

\end{frame}

\begin{frame}
Analogue of Piling Up lemma ...

\end{frame}

\begin{frame}
Combining across SPN rounds ... 

\end{frame}

\begin{frame}
The algorithm for the attack ... 

\end{frame}

\begin{frame}
Probabilistic justification ...

\end{frame}

\subsection{Actual Attacks}
\begin{frame}
Demo of attacks on SPN ... Runtime comparisons with Brute Force ...

\end{frame}

\begin{frame}
Break ... After coming back from the break, we should refresh the basic ideas behind the attacks once again ...

\end{frame}


\section{Attacks on DES}
\begin{frame}
Back to DES ... Pull back from SPN ...

\end{frame}

\subsection{Linear Attack: 3-round DES}
\begin{frame}
Linear Attack idea ... 

\end{frame}

\begin{frame}
Matsui NS for SBoxes ...

\end{frame}

\begin{frame}
Linear approximations for SBoxes ...

\end{frame}

\begin{frame}
Piling up over 3 rounds ...

\end{frame}

\begin{frame}
Demo of the attack ...

\end{frame}

\subsection{Differential Attack: 3-round DES}
\begin{frame}
Differential Attack idea ... 

\end{frame}

\begin{frame}
Differentials for SBoxes ...

\end{frame}

\begin{frame}
Differential characteristics for SBoxes ...

\end{frame}

\begin{frame}
Piling up over 3 rounds ...

\end{frame}

\begin{frame}
Demo of the attack ...

\end{frame}

\subsection{Extension to full DES}
\begin{frame}
Extension of the same ideas to 6 / 8 / 16 round DES ... Probabilistic explanation ...

\end{frame}


\section{Conclusion}
\begin{frame}
Concluding remarks about the project ...

\end{frame}

\subsection{Independence of S-Boxes}
\begin{frame}
Refresh math idea ... Independence assumption ... 

\end{frame}

\begin{frame}
What if that is false ? ... Discussion ...

\end{frame}

\subsection{Number of Pairs Required}
\begin{frame}
Probabilistic possibility of the attacks ... Pairs of data points needed ... 

\end{frame}

\begin{frame}
Generalized attack idea on any given system ... Discussion ...

\end{frame}

\subsection{Links between the Attacks}
\begin{frame}
Links between Linear and Differential Attacks ... 

\end{frame}

\begin{frame}
Mathematically and while implementing ...

\end{frame}

\subsection{Take home Lesson}
\begin{frame}
If you are mounting the attacks ... To Do / Not To Do ...

\end{frame}

\begin{frame}
If you are building a cryptosystem ... To Do / Not To Do ...

\end{frame}

\begin{frame}
Questions ... Doubts ... Coding ... Misc ... Discussion ...

\end{frame}

\end{document}
